<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Donghyuk Lee's Webpage!">
    <title>Donghyuk Lee</title>
    <link rel="icon" type="image/png" sizes="32x32" href="image-removebg-preview.png">
    <link rel="apple-touch-icon" sizes="180x180" href="image-removebg-preview.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.css" />

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            transition: background-color 0.3s, color 0.3s;
            position: relative;
            overflow-x: hidden;
        }

        /* --- Ocean Animation --- */
        .ocean {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2; 
            background: linear-gradient(to top, #92A5C2, #E0E9EF);
            transition: background 0.5s ease-in-out;
        }

        .dark .ocean {
            background: linear-gradient(to top, #023047, #001219);
        }

        .wave {
            background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMjAwIDEyMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+PHBhdGggZD0iTTAsNDEuODNDMTQ5LjQzLDE1LjE3LDMwMS4yNSwwLDQ0OS44OSwyNi43MUM2NTQuNDgsNjIuNjcsODE4LjQ0LDExOS42MiwxMjAwLDk4LjE3VjEyMEgwWiIgb3BhY2l0eT0iLjIiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNLTEuNjgsNjQuNDhjMTU1LjY2LDAsMzE0LjY5LTQxLjM0LDQ3Mi4zMi0yOS4xN0M2NDAuMzIsNDguNjcsNzQ4LjE5LDExOS42MiwxMjAwLDk4LjE3VjEyMEgtMS42OFoiIG9wYWNpdHk9Ii41IiBmaWxsPSIjZmZmIiLz48cGF0aCBkPSJTTAsNjQuNDhjMTQ5LjQzLDE1LjE3LDMwMS4yNSwwLDQ0OS44OS0yNi43MUM2NTQuNDgsNzcuNjcsODE4LjQ0LDU0LjYyLDEyMDAsOTguMTdWMTIwSDBaIiBmaWxsPSIjZmZmIi8+PC9zdmc+) repeat-x;
            position: absolute;
            bottom: 0;
            left: 0;
            width: 6400px;
            height: 198px;
            animation: wave-animation 7s cubic-bezier(0.36, 0.45, 0.63, 0.53) infinite;
            transform: translate3d(0, 0, 0);
            opacity: 0.8;
        }

        .wave:nth-of-type(2) {
            bottom: -25px;
            animation: wave-animation 7s cubic-bezier(0.36, 0.45, 0.63, 0.53) -.125s infinite, swell 7s ease -1.25s infinite;
            opacity: 1;
        }
        
        .dark .wave {
            filter: brightness(0.2);
        }
        
        @keyframes wave-animation {
            0% { margin-left: 0; }
            100% { margin-left: -1600px; }
        }
        @keyframes swell {
            0%, 100% { transform: translate3d(0, -25px, 0); }
            50% { transform: translate3d(0, 5px, 0); }
        }
        
        #bubbles, #fish-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            bottom: -50px;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            animation: rise linear infinite;
        }
        
        .dark .bubble {
             background-color: rgba(255, 255, 255, 0.05);
        }

        @keyframes rise {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        .fish {
            position: absolute;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }
        
        @keyframes swim-ltr {
            0% { transform: translateX(-10vw) scaleX(-1); }
            100% { transform: translateX(110vw) scaleX(-1); }
        }
        
        @keyframes swim-rtl {
            0% { transform: translateX(110vw) scaleX(1); }
            100% { transform: translateX(-10vw) scaleX(1); }
        }

        header, main {
            position: relative;
            z-index: 10;
        }
        
        body { background-color: transparent; }
        .dark body { 
             background-color: transparent; 
             color: #ffffff;
        }

        .card { background-color: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); }
        .dark .card { background-color: rgba(45, 55, 72, 0.7); border-color: #4a5568; }
        .dark .btn { background-color: #4a5568; color: #e2e8f0; }
        .dark input, .dark textarea { background-color: #4a5568; border-color: #4a5568; color: #e2e8f0; }
        .dark .comment-box { background-color: #4a5568; }
        .modal { transition: opacity 0.3s ease-in-out; }

        .dark #modal-title, .dark #modal-content {
            color: #000000;
        }
        
        .nav-btn {
            color: #374151;
            transition: all 0.3s ease-in-out;
        }
        .dark .nav-btn {
            color: #d1d5db;
        }

        .nav-btn:not(.active):hover { background-color: #e5e7eb; transform: translateY(-2px); }
        .dark .nav-btn:not(.active):hover { background-color: #374151; }
        
        .nav-btn.active {
            font-weight: 600;
            background-color: #3b82f6;
            color: #ffffff !important; 
        }
        .nav-btn.active:hover { filter: brightness(1.1); }

        .content-section {
            transition: opacity 0.3s ease-in-out;
        }
        .prose { max-width: none; }

        .dark .prose-invert * {
            color: #ffffff;
        }
        .dark .prose-invert a {
            color: #60a5fa;
        }
        .dark .prose-invert a:hover {
            color: #93c5fd;
        }

        .theme-switch {
            display: inline-block;
            height: 34px;
            width: 60px;
            position: relative;
            background-color: #f1f1f1;
            border-radius: 34px;
            cursor: pointer;
            transition: background-color 0.3s;
            border: 1px solid #ccc;
        }
        .dark .theme-switch {
            background-color: #4a5568;
            border-color: #374151;
        }

        .theme-switch__knob {
            position: absolute;
            top: 2px;
            left: 2px;
            height: 28px;
            width: 28px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .dark .theme-switch__knob {
            transform: translateX(26px);
        }

        .theme-switch__icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            fill: #6b7280;
            transition: opacity 0.2s;
        }
        .dark .theme-switch__icon {
             fill: #e5e7eb;
        }

        .theme-switch__icon--sun {
            opacity: 1;
        }
        .dark .theme-switch__icon--sun {
            opacity: 0;
        }

        .theme-switch__icon--moon {
            opacity: 0;
            right: 6px;
        }
        .dark .theme-switch__icon--moon {
            opacity: 1;
        }

        #typed-text::after {
            content: '|';
            display: inline-block;
            margin-left: 0.2rem;
            animation: blink 0.7s infinite;
        }
        
        #typed-text.light-mode::after {
             color: #3b82f6;
        }
        
        #typed-text.dark-mode::after {
             color: #60a5fa;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* START: CSS FOR SKILL BADGES */
        .skill-badge {
            display: inline-block;
            /* UPDATED: 스킬 배지 크기 축소 */
            padding: 0.25rem 0.75rem; /* 4px 12px */
            font-size: 0.75rem;      /* 12px */
            font-weight: 500;
            border-radius: 9999px; /* pill shape */
            transition: transform 0.2s ease-in-out, background-color 0.2s;
        }

        .skill-badge:hover {
            transform: translateY(-2px);
        }

        /* Light Mode Styles */
        .skill-badge {
            background-color: #e5e7eb; /* gray-200 */
            color: #1f2937; /* gray-800 */
        }

        /* Dark Mode Styles */
        .dark .skill-badge {
            background-color: #374151; /* gray-700 */
            color: #f9fafb; /* gray-50 */
        }
        /* END: CSS FOR SKILL BADGES */
    </style>
</head>
<body class="text-gray-800 dark:text-gray-200">

    <div class="ocean">
        <div class="wave"></div>
        <div class="wave"></div>
    </div>
    <div id="bubbles"></div>
    <div id="fish-container"></div>


    <div id="modal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none z-50 p-4">
        <div class="bg-white dark:bg-gray-700 p-6 rounded-xl shadow-lg w-full max-w-md text-center">
            <h3 id="modal-title" class="text-xl font-semibold mb-4"></h3>
            <div id="modal-content" class="text-gray-600 dark:text-gray-300 mb-6 text-left"></div>
            <div class="flex justify-end space-x-2">
                 <button id="modal-confirm-btn" class="modal-action-btn btn bg-blue-500 text-white px-4 py-2 rounded-full hidden">Save</button>
                 <button id="modal-close-btn" class="btn bg-gray-300 px-4 py-2 rounded-full">Close</button>
            </div>
        </div>
    </div>

    <div id="login-modal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none z-50 p-4">
        <div class="bg-white dark:bg-gray-700 p-6 rounded-xl shadow-lg w-full max-w-md">
            <h3 class="text-2xl font-bold mb-6 text-center">Login</h3>
            <div id="firebaseui-auth-container"></div>
            <button id="login-modal-close-btn" class="w-full mt-4 btn bg-gray-300 px-4 py-2 rounded-full">Close</button>
        </div>
    </div>
    
    <div id="new-blog-post-modal" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg w-full max-w-2xl">
            <h3 class="text-2xl font-bold mb-6 text-center">Create New Blog Post</h3>
            <form id="new-blog-post-form" class="space-y-4">
                <input type="text" id="new-blog-post-title" placeholder="Post Title" class="w-full p-3 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500">
                <textarea id="new-blog-post-content" rows="8" placeholder="Write your story..." class="w-full p-4 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                <div>
                    <label for="new-blog-post-image" class="text-sm font-medium">Cover Image (Optional)</label>
                    <input type="file" id="new-blog-post-image" accept="image/*" class="w-full mt-1 text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                </div>
                <input type="text" id="new-blog-post-tags" placeholder="Tags (comma-separated, e.g., tech, travel)" class="w-full p-3 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500">
                <div class="flex justify-end space-x-2">
                    <button type="button" id="new-blog-post-close-btn" class="btn bg-gray-300 px-4 py-2 rounded-full">Cancel</button>
                    <button type="submit" class="btn bg-blue-600 text-white px-4 py-2 rounded-full">Publish Post</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="blog-article-modal" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto">
            <div id="blog-article-modal-content" class="text-left">
            </div>
            <button id="blog-article-modal-close-btn" class="w-full mt-4 btn bg-gray-300 px-4 py-2 rounded-full">Close</button>
        </div>
    </div>


    <header class="bg-white/70 dark:bg-gray-800/70 shadow-md sticky top-0 z-40 backdrop-blur-sm">
        <div class="container mx-auto px-4 py-2 flex justify-between items-center relative">
            <a href="#" onclick="event.preventDefault(); window.showSection('about')" class="cursor-pointer flex items-center space-x-4">
                <img src="image-removebg-preview.png" alt="welcome logo" class="h-12 sm:h-16 w-auto"> 
                <div class="border-l border-gray-300 dark:border-gray-600 h-10"></div>
                <img src="kaist_logo.png" alt="KAIST logo" class="h-8 sm:h-10 w-auto relative top-0.5">
            </a>
            
            <div class="hidden md:flex flex-col items-end">
                <nav class="flex space-x-2 items-center">
                    <button onclick="window.showSection('about')" class="nav-btn btn px-4 py-2 rounded-full" data-section="about">About</button>
                    <button onclick="window.showSection('research')" class="nav-btn btn px-4 py-2 rounded-full" data-section="research">CV</button>
                    <button onclick="window.showSection('blog')" class="nav-btn btn px-4 py-2 rounded-full" data-section="blog">Blog</button>
                    <button onclick="window.showSection('community')" class="nav-btn btn px-4 py-2 rounded-full" data-section="community">Com.</button>
                    
                    <div id="dark-mode-toggle" class="theme-switch" aria-label="Toggle dark mode">
                        <div class="theme-switch__icon theme-switch__icon--moon">
                             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.29,15.29A10,10,0,1,1,8.71,6.71,8,8,0,0,0,17.29,15.29Z"/></svg>
                        </div>
                        <div class="theme-switch__knob">
                            <div class="theme-switch__icon theme-switch__icon--sun">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2ZM12,20a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/><rect width="2" height="4" x="11" y="1"/><rect width="4" height="2" x="19" y="11"/><rect width="2" height="4" x="11" y="19"/><rect width="4" height="2" x="1" y="11"/><rect width="2.83" height="2.83" x="4.54" y="4.54" transform="rotate(-45 5.95 5.95)"/><rect width="2.83" height="2.83" x="16.63" y="16.63" transform="rotate(-45 18.044 18.044)"/><rect width="2.83" height="2.83" x="4.54" y="16.63" transform="rotate(-135 5.95 18.04)"/><rect width="2.83" height="2.83" x="16.63" y="4.54" transform="rotate(134.999 18.04 5.95)"/></svg>
                            </div>
                        </div>
                    </div>

                    <button id="login-btn" class="btn bg-blue-500 text-white px-4 py-2 rounded-full" style="display: none;">Login</button>
                    <button id="logout-btn" class="btn bg-red-500 text-white px-4 py-2 rounded-full" style="display: none;">Logout</button>
                </nav>
                <div class="h-4 mt-1">
                    <span id="login-status-desktop" class="text-xs text-gray-500"></span>
                </div>
            </div>
            
            <div class="md:hidden">
                <button id="hamburger-btn" class="focus:outline-none p-2" aria-controls="mobile-menu" aria-expanded="false">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
            
            <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full bg-white/90 dark:bg-gray-800/90 shadow-lg backdrop-blur-sm">
                <nav class="flex flex-col items-center p-4 space-y-2">
                    <button onclick="window.showSection('about')" class="nav-btn btn w-full py-2 rounded-full" data-section="about">About</button>
                    <button onclick="window.showSection('research')" class="nav-btn btn w-full py-2 rounded-full" data-section="research">CV</button>
                    <button onclick="window.showSection('blog')" class="nav-btn btn w-full py-2 rounded-full" data-section="blog">Blog</button>
                    <button onclick="window.showSection('community')" class="nav-btn btn w-full py-2 rounded-full" data-section="community">Com.</button>
                    
                    <div id="dark-mode-toggle-mobile" class="theme-switch" aria-label="Toggle dark mode">
                        <div class="theme-switch__icon theme-switch__icon--moon">
                             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.29,15.29A10,10,0,1,1,8.71,6.71,8,8,0,0,0,17.29,15.29Z"/></svg>
                        </div>
                        <div class="theme-switch__knob">
                            <div class="theme-switch__icon theme-switch__icon--sun">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2ZM12,20a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/><rect width="2" height="4" x="11" y="1"/><rect width="4" height="2" x="19" y="11"/><rect width="2" height="4" x="11" y="19"/><rect width="4" height="2" x="1" y="11"/><rect width="2.83" height="2.83" x="4.54" y="4.54" transform="rotate(-45 5.95 5.95)"/><rect width="2.83" height="2.83" x="16.63" y="16.63" transform="rotate(-45 18.044 18.044)"/><rect width="2.83" height="2.83" x="4.54" y="16.63" transform="rotate(-135 5.95 18.04)"/><rect width="2.83" height="2.83" x="16.63" y="4.54" transform="rotate(134.999 18.04 5.95)"/></svg>
                            </div>
                        </div>
                    </div>

                    <button id="login-btn-mobile" class="btn w-full py-2 bg-blue-500 text-white rounded-full" style="display: none;">Login</button>
                    <button id="logout-btn-mobile" class="btn w-full py-2 bg-red-500 text-white rounded-full" style="display: none;">Logout</button>
                </nav>
                <div class="text-center pb-4">
                     <span id="login-status-mobile" class="text-xs text-gray-500"></span>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-8">
        <section id="about" class="hidden max-w-4xl mx-auto card bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 sm:p-8 rounded-3xl shadow-lg border border-gray-200 content-section">
            <div class="text-center">
                <img src="IMG_7859.jpeg" alt="Profile Picture" class="rounded-full w-40 h-40 sm:w-60 sm:h-60 mx-auto mb-6 shadow-md object-cover">
                <p class="text-lg sm:text-xl text-gray-600 dark:text-gray-300 min-h-[2.5em]">
                    > I'm <span id="typed-text" class="font-semibold text-blue-600 dark:text-blue-400"></span>
                </p>
            </div>
            
            <div id="skills-container" class="flex flex-wrap justify-center gap-3">
            </div>

            <div class="prose dark:prose-invert max-w-none text-base sm:text-lg leading-relaxed mt-4">
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">Brief Introduction</h3>
                <p class="mb-4">Hello! I'm currently an undergraduate student at KAIST. During my time at a science high school, I conducted various research related to neurobiology and bioengineering. Most recently, I studied how to predict genotypes and improve data bias using artificial neural network algorithms. I plan to enter the Department of Electrical Engineering at KAIST and within the Computer Science Division. I have a broad interest in statistical inference models, information theory, and artificial intelligence models for research.</p>
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">Experience</h3>
                <ul class="list-disc ml-6 space-y-2">
                    <li>pre-URP at YOON LAB, Department of Biological Sciences, KAIST (2023.06 - 2023.09)</li>
                </ul>
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">Education</h3>
                <ul class="list-disc ml-6 space-y-2">
                    <li>Gyeonggi Buk Science High School (2022.03 - 2025.01)</li>
                    <li>KAIST, Department of Electrical & Electronic Engineering (2025.02 - )</li>
                </ul>
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">Contact</h3>
                 <div class="flex items-center space-x-4">
                    <a href="https://www.linkedin.com/in/%EB%8F%99%ED%98%81-%EC%9D%B4-140a622b0/" target="_blank" rel="noopener noreferrer" class="transition-transform hover:scale-110">
                        <img src="linkedin_logo.png" alt="linkedin" class="h-12 sm:h-12 w-auto">
                    </a>
                    <a href="https://www.instagram.com/dhleethan/" target="_blank" rel="noopener noreferrer" class="transition-transform hover:scale-110">
                        <img src="instagram_logo.png" alt="instagram" class="h-12 sm:h-12 w-auto">
                    </a>
                    <div class="border-l border-gray-400 dark:border-gray-500 h-6 mx-2"></div>
                    <a href="mailto:dhlee4832@kaist.ac.kr" class="text-blue-500 hover:underline text-base sm:text-lg transition-colors hover:text-blue-700 dark:hover:text-blue-300">dhlee4832@kaist.ac.kr</a>
                </div>
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">My Previous Works</h3>
                <ul class="list-disc ml-6 space-y-2">
                    <li><a href="https://donghyuklee1.github.io/CV/assets/presentation_slides.pdf" class="text-blue-500 hover:underline">I will upload CV pdf later!</a></li>
                </ul>
            </div>
        </section>
        <section id="research" class="hidden max-w-4xl mx-auto card bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 sm:p-8 rounded-3xl shadow-lg border border-gray-200 content-section">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-center">Bio(-2024.)</h2>
            <div class="prose dark:prose-invert max-w-none text-base sm:text-lg leading-relaxed">
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">Awards and Major Achievements</h3>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 Gyeonggi Science Fair Excellence Award (2nd place):</b> Received the award for the study on 'Chemotaxis of the Pseudomonas fluorescens-powered biological microrobot towards cancer cells.'</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 National High School Science Olympiad Bronze Medal:</b> Awarded the bronze medal among 56 representatives from 28 science and gifted schools nationwide.</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 National Bio-Data Utilization Competition Pass:</b> The only high school student to pass with 'Development of a Non-invasive Comprehensive Diabetic Complication Diagnosis Model based on Liquid-Biopsy using XAI.'</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 Advanced Research Immersion Program for Science-Gifted Students (Pre-URP) with Honors:</b> Completed the Pre-URP program with honors.</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 Gyeonggi Northern Science High School In-house Life Science Experiment Challenge Grand Prize.</b></p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 Korea Brain Camp Completion.</b></p>
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">High School Research Activities</h3>
                <p class="text-sm text-gray-500">2022</p>
                <p class="mt-1"><b>2022 Creative Individual Research:</b> Conducted research on 'Fabrication of I202T mutant mCherry-pBHA transformed E.Coli using SDM and evaluation of pH sensitivity as a biocompatible micro pH-meter.'</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 1st Semester Creative Individual Research:</b> Studied the 'Epigenetic prediction of the mechanism inducing Alzheimer's disease through genetic network learning.'</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>2023 2nd Semester Creative Individual Research:</b> Performed research on 'Development of a Non-invasive Comprehensive Diabetic Complication Diagnosis Model based on Liquid-Biopsy using Explainable Artificial Intelligence (XAI).'</p>
                <p class="text-sm text-gray-500">2024</p>
                <p class="mt-1"><b>2024 1st Semester Creative Individual Research:</b> Studied the 'Correlation between the transformation and prediction of gene expression data using a Generative Adversarial Network and the improvement of epigenetic aging profiling performance.'</p>
                <p class="text-sm text-gray-500">2022 ~ 2024</p>
                <p class="mt-1"><b>RnE Research:</b> Conducted research on 'Chemotaxis of the Pseudomonas fluorescens-powered biological microrobot towards cancer cells' and 'The correlation between biofilm formation and R.palustris battery efficiency according to the 3D electrode pre-processing method.'</p>
                <p class="text-sm text-gray-500">2024</p>
                <p class="mt-1"><b>KAIST Collaborative Research:</b> Participated in research to 'elucidate cell-specific transcriptome dynamics during human cerebral organoid development.'</p>
                <h3 class="text-xl sm:text-2xl font-semibold mt-8 mb-4">In-house Seminars and Lectures</h3>
                <p class="text-sm text-gray-500">2022</p>
                <p class="mt-1"><b>AD Biology Abstract & System Biology seminar:</b> Presented on 'GNN models based on graph theory and the Alzheimer's disease induction mechanism.'</p>
                <p class="text-sm text-gray-500">2023</p>
                <p class="mt-1"><b>CoMBI Computational Science Seminar:</b> Conducted a seminar on the topic 'AI-driven drug discovery "Attention architecture".'</p>
                <p class="text-sm text-gray-500">2024</p>
                <p class="mt-1"><b>The Nitroplast Seminar:</b> Covered the topic 'The first organelle capable of nitrogen fixation has been discovered in eukaryotes.'</p>
                <p class="text-sm text-gray-500">2024</p>
                <p class="mt-1"><b>CoMBI Bioinformatics Seminar:</b> Gave lectures on the 'basics of bioinformatics and system biology.'</p>
            </div>
        </section>

        <section id="blog" class="hidden max-w-5xl mx-auto content-section">
             <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl sm:text-4xl font-bold">Blog</h2>
                <button id="new-blog-post-btn" style="display: none;" class="btn bg-blue-500 text-white px-4 py-2 rounded-full">Add a Blog</button>
            </div>
            <div class="mb-6 flex flex-col sm:flex-row gap-4">
                <input type="search" id="blog-search-input" placeholder="Search posts..." class="w-full sm:w-1/3 p-2 rounded-full border bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                <div id="categories-container" class="flex flex-wrap gap-2 items-center">
                </div>
            </div>
            <div id="blog-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
        </section>

        <section id="community" class="hidden max-w-4xl mx-auto content-section">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-center">Community</h2>
            
            <div id="new-post-section" class="card bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 rounded-3xl shadow-lg mb-8 border" style="display: none;">
                <h3 class="text-xl sm:text-2xl font-semibold mb-4">Create a new post✍🏻</h3>
                <form id="new-community-post-form">
                    <input type="text" id="new-community-post-title" placeholder="Please enter a title" class="w-full p-3 mb-4 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <textarea id="new-community-post-content" rows="6" placeholder="Share your amazing story!" class="w-full p-4 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    <button type="submit" class="btn w-full mt-4 bg-blue-600 text-white p-3 rounded-full">Posting</button>
                </form>
            </div>

            <div id="login-prompt" class="card bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm text-center p-6 sm:p-8 rounded-3xl shadow-lg mb-8 border" style="display: none;">
                <h3 class="text-xl sm:text-2xl font-semibold mb-4">Post anything!</h3>
                <p class="mb-6">Please leave any questions or inquiries and I will respond as soon as I read them!</p>
                <button onclick="window.showLoginModal()" class="btn bg-blue-500 text-white px-6 py-3 rounded-full">Log in and post</button>
            </div>
            
            <div id="community-posts-container"></div>
        </section>
    </main>

    <footer class="text-center py-8 text-sm text-gray-500 dark:text-gray-400 relative z-10">
        <p>&copy; 2025 Donghyuk Lee</p>
    </footer>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>
    
    <script type="module">
        const firebaseConfig = {
            apiKey: "AIzaSyDZ73acZGuPE-9uwUy_90d2c4zQEEKOMvc",
            authDomain: "website-4b4f8.firebaseapp.com",
            projectId: "website-4b4f8",
            storageBucket: "website-4b4f8.appspot.com",
            messagingSenderId: "965602529024",
            appId: "1:965602529024:web:14b4ea2f7f214b7dbade5",
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();
        const appId = firebaseConfig.projectId;
        
        let userId;

        // --- Global State ---
        let communityPostsUnsubscribe;
        const communityPostsData = {};
        let blogArticlesUnsubscribe;
        let allBlogArticles = [];

        // --- DOM Elements ---
        const skillsContainer = document.getElementById('skills-container');
        const communityPostsContainer = document.getElementById('community-posts-container');
        const newCommunityPostForm = document.getElementById('new-community-post-form');
        const loginStatusDesktop = document.getElementById('login-status-desktop');
        const loginStatusMobile = document.getElementById('login-status-mobile');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const darkModeToggleMobile = document.getElementById('dark-mode-toggle-mobile');
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const modalConfirmBtn = document.getElementById('modal-confirm-btn');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const loginModal = document.getElementById('login-modal');
        const newPostSection = document.getElementById('new-post-section');
        const loginPrompt = document.getElementById('login-prompt');
        const mobileMenu = document.getElementById('mobile-menu');
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const loginButtons = [document.getElementById('login-btn'), document.getElementById('login-btn-mobile')];
        const logoutButtons = [document.getElementById('logout-btn'), document.getElementById('logout-btn-mobile')];
        const blogContainer = document.getElementById('blog-container');
        const categoriesContainer = document.getElementById('categories-container');
        const blogSearchInput = document.getElementById('blog-search-input');
        const newBlogPostModal = document.getElementById('new-blog-post-modal');
        const newBlogPostForm = document.getElementById('new-blog-post-form');
        const newBlogPostBtn = document.getElementById('new-blog-post-btn');
        const blogArticleModal = document.getElementById('blog-article-modal');
        const blogArticleModalContent = document.getElementById('blog-article-modal-content');
        const blogArticleModalCloseBtn = document.getElementById('blog-article-modal-close-btn');
        const bubblesContainer = document.getElementById('bubbles');
        const typedTextElement = document.getElementById('typed-text');

        // --- Firebase UI ---
        const ui = new firebaseui.auth.AuthUI(auth);
        const uiConfig = {
            callbacks: { signInSuccessWithAuthResult: () => { window.hideLoginModal(); return false; } },
            signInFlow: 'popup',
            signInOptions: [ firebase.auth.GoogleAuthProvider.PROVIDER_ID, firebase.auth.EmailAuthProvider.PROVIDER_ID ],
        };
        
        // --- Typing Animation Logic ---
        const textArray = ["Donghyuk Lee", "a ski lover ⛷️", "a member of KAIST Include!", "a member of KARVE!", "a banana 🍌", "studying REACT", "good at Python 🐍"];
        const typingDelay = 100;
        const erasingDelay = 50;
        const newTextDelay = 2000;
        let textArrayIndex = 0;
        let charIndex = 0;

        function type() {
            if (charIndex < textArray[textArrayIndex].length) {
                typedTextElement.textContent += textArray[textArrayIndex].charAt(charIndex);
                charIndex++;
                setTimeout(type, typingDelay);
            } else {
                setTimeout(erase, newTextDelay);
            }
        }

        function erase() {
            if (charIndex > 0) {
                typedTextElement.textContent = textArray[textArrayIndex].substring(0, charIndex - 1);
                charIndex--;
                setTimeout(erase, erasingDelay);
            } else {
                textArrayIndex++;
                if (textArrayIndex >= textArray.length) textArrayIndex = 0;
                setTimeout(type, typingDelay + 500);
            }
        }

        // --- Skills Logic ---
        const mySkills = ["Python", "Javascript", "React", "HTML5", "CSS", "TailwindCSS", "C", "C++"];

        function renderSkills() {
            if (!skillsContainer) return;
            skillsContainer.innerHTML = mySkills.map(skill => `<div class="skill-badge">${skill}</div>`).join('');
        }

        // --- Helper Functions ---
        function formatTimestamp(timestamp) {
            if (!timestamp || !timestamp.toDate) return '';
            const date = timestamp.toDate();
            const now = new Date();
            const diffMs = now - date;
            const diffSecs = Math.round(diffMs / 1000);
            const diffMins = Math.round(diffSecs / 60);
            const diffHours = Math.round(diffMins / 60);
            const diffDays = Math.round(diffHours / 24);

            if (diffSecs < 60) return `${diffSecs}s ago`;
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHours < 24) return `${diffHours}h ago`;
            if (diffDays < 7) return `${diffDays}d ago`;
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }
        
        function createBubbles() {
            for (let i = 0; i < 50; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                const size = Math.random() * 20 + 5 + 'px';
                bubble.style.width = size;
                bubble.style.height = size;
                bubble.style.left = Math.random() * 100 + 'vw';
                bubble.style.animationDuration = Math.random() * 10 + 10 + 's';
                bubble.style.animationDelay = Math.random() * 10 + 's';
                bubblesContainer.appendChild(bubble);
            }
        }

        function createFish() {
            const fishContainer = document.getElementById('fish-container');
            if (!fishContainer) return;
            const fishEmojis = ['🐠', '🐟', '🐡'];
            for (let i = 0; i < 10; i++) {
                const fish = document.createElement('div');
                fish.className = 'fish';
                fish.innerHTML = fishEmojis[Math.floor(Math.random() * fishEmojis.length)];
                fish.style.top = Math.random() * 85 + 5 + '%'; 
                fish.style.fontSize = Math.random() * 40 + 25 + 'px';
                const duration = Math.random() * 12 + 8;
                fish.style.animationDuration = duration + 's';
                fish.style.animationDelay = '-' + (Math.random() * duration) + 's';
                fish.style.animationName = (Math.random() < 0.5) ? 'swim-ltr' : 'swim-rtl';
                fishContainer.appendChild(fish);
            }
        }

        // --- Auth State Change Handler ---
        auth.onAuthStateChanged(async (user) => {
            const statusMessage = user && !user.isAnonymous ? `${user.displayName || user.email.split('@')[0]}, Welcome!` : 'You\'re not logged-in :(';
            loginStatusDesktop.innerHTML = statusMessage;
            loginStatusMobile.innerHTML = statusMessage;

            if (user && !user.isAnonymous) {
                userId = user.uid;
                loginButtons.forEach(btn => btn.style.display = 'none');
                logoutButtons.forEach(btn => btn.style.display = 'inline-block');
                newPostSection.style.display = 'block';
                loginPrompt.style.display = 'none';
                newBlogPostBtn.style.display = 'block';

                const userSettingsRef = db.doc(`artifacts/${appId}/users/${userId}/settings/theme`);
                const userSettingsSnap = await userSettingsRef.get();
                if (userSettingsSnap.exists && userSettingsSnap.data().darkMode) {
                    document.documentElement.classList.add('dark');
                }
            } else {
                userId = user ? user.uid : null;
                loginButtons.forEach(btn => btn.style.display = 'inline-block');
                logoutButtons.forEach(btn => btn.style.display = 'none');
                newPostSection.style.display = 'none';
                loginPrompt.style.display = 'block';
                newBlogPostBtn.style.display = 'none';
            }
            setupCommunityListener();
            setupBlogArticleListener();
        });
        
        // --- Community Logic ---
        function setupCommunityListener() {
            if (communityPostsUnsubscribe) communityPostsUnsubscribe();
            communityPostsUnsubscribe = db.collection(`artifacts/${appId}/public/data/blog_posts`)
                .orderBy("timestamp", "desc")
                .onSnapshot((snapshot) => {
                    communityPostsContainer.innerHTML = '';
                    snapshot.forEach((doc) => {
                        const post = doc.data();
                        const postId = doc.id;
                        communityPostsData[postId] = post;
                        renderCommunityPost(postId, post);
                    });
                });
        }
        
        function renderCommunityPost(postId, post) {
             const postElement = document.createElement('div');
             postElement.className = 'card bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 mb-4 rounded-xl shadow-lg border';
             const userLiked = post.likes && post.likes.includes(userId);

             postElement.innerHTML = `
                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-4">
                    <div>
                        <h3 class="text-2xl font-semibold mb-2">${post.title || 'no title'}</h3>
                        <div class="flex items-center space-x-2 text-sm text-gray-500 whitespace-nowrap">
                           <p>Posted by: ${post.authorName || 'anonymous'}</p>
                           <span>•</span>
                           <p>${formatTimestamp(post.timestamp)}</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2 self-end sm:self-start flex-shrink-0">
                        <span class="text-red-500">${post.likes ? post.likes.length : 0}</span>
                        <button onclick="window.likePost('${postId}')" class="btn px-3 py-1 rounded-full text-sm ${userLiked ? 'text-red-500 bg-red-100 dark:bg-gray-700' : 'bg-gray-200 dark:bg-gray-700'}">
                            ${userLiked ? '♥' : '♡'}
                        </button>
                        ${post.userId === userId ? `
                            <button onclick="window.editPost('${postId}')" class="btn bg-blue-500 text-white px-3 py-1 rounded-full text-sm">Edit</button>
                            <button onclick="window.deletePost('${postId}')" class="btn bg-red-500 text-white px-3 py-1 rounded-full text-sm">Delete</button>
                        ` : ''}
                    </div>
                </div>
                <p class="mb-4 whitespace-pre-wrap">${post.content}</p>
                <div class="comments-container border-t pt-4 mt-4">
                    <h4 class="font-semibold mb-2">Comments</h4>
                    <div id="comments-list-${postId}" class="space-y-2"></div>
                    <form onsubmit="event.preventDefault(); window.addComment('${postId}', this.commentContent.value); this.reset();" class="mt-4">
                        <input type="text" name="commentContent" placeholder="Add a comment..." class="w-full p-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button type="submit" class="btn w-full mt-2 bg-blue-500 text-white p-2 rounded-lg">Submit</button>
                    </form>
                </div>
            `;
            communityPostsContainer.appendChild(postElement);

            const commentsList = document.getElementById(`comments-list-${postId}`);
            if (post.comments) {
                post.comments.sort((a,b) => (a.timestamp?.toMillis() || 0) - (b.timestamp?.toMillis() || 0)).forEach((comment, index) => {
                    const commentItem = document.createElement('div');
                    commentItem.className = 'comment-box p-2 rounded-lg text-sm flex justify-between items-start gap-4';
                    commentItem.innerHTML = `
                        <div class="flex-grow min-w-0">
                            <p><span class="font-semibold">${comment.authorName || 'anonymous'}:</span> ${comment.content}</p>
                        </div>
                        <div class="flex items-center space-x-2 flex-shrink-0">
                            <span class="text-xs text-gray-400 whitespace-nowrap">${formatTimestamp(comment.timestamp)}</span>
                            ${comment.userId === userId ? `<button onclick="window.deleteComment('${postId}', ${index})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>` : ''}
                        </div>
                    `;
                    commentsList.appendChild(commentItem);
                });
            }
        }
        
        newCommunityPostForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const user = auth.currentUser;
            if (!user || user.isAnonymous) { window.showModal('Error', 'Login is required to post.'); return; }
            const postTitle = document.getElementById('new-community-post-title').value;
            const postContent = document.getElementById('new-community-post-content').value;
            if (postTitle.trim() === '' || postContent.trim() === '') { window.showModal('Attention', 'Please enter both a title and content.'); return; }

            const newPost = {
                title: postTitle, content: postContent, userId: user.uid,
                authorName: user.displayName || user.email.split('@')[0],
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                likes: [], comments: []
            };

            try {
                await db.collection(`artifacts/${appId}/public/data/blog_posts`).add(newPost);
                newCommunityPostForm.reset();
                window.showModal('Success', 'Your post has been added!');
            } catch (error) { console.error("Error adding post:", error); window.showModal('Error', 'Failed to add the post.'); }
        });
        
        window.likePost = async (postId) => {
            const user = auth.currentUser;
            if (!user || user.isAnonymous) { window.showModal('Notice', 'Login is required to like a post.'); return; }
            const postRef = db.doc(`artifacts/${appId}/public/data/blog_posts/${postId}`);
            
            try {
                const doc = await postRef.get();
                if (!doc.exists) return;
                const post = doc.data();
                const likes = post.likes || [];
                
                if (likes.includes(user.uid)) {
                    await postRef.update({ likes: firebase.firestore.FieldValue.arrayRemove(user.uid) });
                } else {
                    await postRef.update({ likes: firebase.firestore.FieldValue.arrayUnion(user.uid) });
                }
            } catch (error) {
                console.error("Error liking post:", error);
                window.showModal('Error', 'Could not update like status.');
            }
        };

        window.addComment = async (postId, commentContent) => {
            const user = auth.currentUser;
            if (!user || user.isAnonymous) { window.showModal('Notice', 'Login is required to comment.'); return; }
            if (!commentContent.trim()) return;
            
            const newComment = {
                userId: user.uid,
                authorName: user.displayName || user.email.split('@')[0],
                content: commentContent,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            const postRef = db.doc(`artifacts/${appId}/public/data/blog_posts/${postId}`);
            
            try {
                await postRef.update({ comments: firebase.firestore.FieldValue.arrayUnion(newComment) });
            } catch (error) {
                console.error("Error adding comment:", error);
                window.showModal('Error', 'Failed to add the comment.');
            }
        };

        window.deletePost = (postId) => {
            window.showModal('Confirm', 'Are you sure you want to delete this post?', () => {
                db.doc(`artifacts/${appId}/public/data/blog_posts/${postId}`).delete()
                  .catch(error => window.showModal('Error', 'Failed to delete the post.'));
            }, true);
        };

        window.editPost = (postId) => {
            const post = communityPostsData[postId];
            const modalHTML = `
                <input type="text" id="edit-post-title" value="${post.title || ''}" class="w-full p-3 mb-4 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500">
                <textarea id="edit-post-content" rows="6" class="w-full p-4 rounded-xl border focus:outline-none focus:ring-2 focus:ring-blue-500">${post.content}</textarea>
            `;
            window.showModal('Edit Post', modalHTML, () => {
                const newTitle = document.getElementById('edit-post-title').value;
                const newContent = document.getElementById('edit-post-content').value;
                if (newTitle && newContent) {
                    db.doc(`artifacts/${appId}/public/data/blog_posts/${postId}`).update({ title: newTitle, content: newContent })
                      .catch(error => window.showModal('Error', 'Failed to edit the post.'));
                }
            }, true);
        };
        
        window.deleteComment = (postId, commentIndex) => {
            window.showModal('Confirm', 'Are you sure you want to delete this comment?', async () => {
                const postRef = db.doc(`artifacts/${appId}/public/data/blog_posts/${postId}`);
                try {
                    await db.runTransaction(async (transaction) => {
                        const doc = await transaction.get(postRef);
                        if (!doc.exists) throw "Document does not exist!";
                        
                        const post = doc.data();
                        const comments = post.comments || [];
                        
                        comments.sort((a,b) => (a.timestamp?.toMillis() || 0) - (b.timestamp?.toMillis() || 0));
                        
                        if (comments[commentIndex]) {
                            comments.splice(commentIndex, 1);
                            transaction.update(postRef, { comments: comments });
                        }
                    });
                } catch (error) {
                    console.error("Error deleting comment:", error);
                    window.showModal('Error', 'Failed to delete the comment.');
                }
            }, true);
        };

        // --- Blog Logic ---
        function setupBlogArticleListener() {
            if (blogArticlesUnsubscribe) blogArticlesUnsubscribe();
            blogArticlesUnsubscribe = db.collection(`artifacts/${appId}/public/data/blog_articles`)
                .orderBy("timestamp", "desc")
                .onSnapshot(snapshot => {
                    allBlogArticles = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    renderCategories();
                    renderFilteredBlogArticles();
                });
        }

        function renderCategories() {
            const allTags = allBlogArticles.flatMap(article => article.tags || []);
            const uniqueTags = ['All', ...new Set(allTags)];

            categoriesContainer.innerHTML = uniqueTags.map(tag =>
                `<button class="category-btn btn px-3 py-1 rounded-full text-sm bg-gray-200 dark:bg-gray-700 hover:bg-blue-500 hover:text-white" data-category="${tag}">${tag}</button>`
            ).join('');

            const categoryBtns = categoriesContainer.querySelectorAll('.category-btn');
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    categoryBtns.forEach(b => b.classList.remove('active-category', 'bg-blue-500', 'text-white'));
                    btn.classList.add('active-category', 'bg-blue-500', 'text-white');
                    renderFilteredBlogArticles();
                });
            });
            categoryBtns[0]?.classList.add('active-category', 'bg-blue-500', 'text-white');
        }

        function renderFilteredBlogArticles() {
            const activeCategory = categoriesContainer.querySelector('.active-category')?.dataset.category || 'All';
            const searchTerm = blogSearchInput.value.toLowerCase();

            const filteredArticles = allBlogArticles.filter(article => {
                const categoryMatch = activeCategory === 'All' || (article.tags && article.tags.includes(activeCategory));
                const searchMatch = !searchTerm || article.title.toLowerCase().includes(searchTerm) || article.content.toLowerCase().includes(searchTerm);
                return categoryMatch && searchMatch;
            });

            blogContainer.innerHTML = '';
            if (filteredArticles.length === 0) {
                blogContainer.innerHTML = `<p class="col-span-full text-center text-gray-500">No posts found.</p>`;
                return;
            }
            filteredArticles.forEach(renderBlogArticle);
        }

        function renderBlogArticle(article) {
            const articleElement = document.createElement('div');
            articleElement.className = 'card bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm overflow-hidden rounded-xl shadow-lg border';
            articleElement.innerHTML = `
                ${article.imageURL ? `<img class="w-full h-48 object-cover" src="${article.imageURL}" alt="${article.title}">` : ''}
                <div class="p-6">
                    <div class="flex flex-wrap gap-2 mb-2">
                        ${(article.tags || []).map(tag => `<span class="bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full dark:bg-blue-200 dark:text-blue-800">#${tag}</span>`).join('')}
                    </div>
                    <h3 class="text-2xl font-bold mb-2">${article.title}</h3>
                    <p class="text-sm text-gray-500 mb-4">By ${article.authorName} • ${formatTimestamp(article.timestamp)}</p>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${article.content.substring(0, 150)}...</p>
                    <a href="#" onclick="event.preventDefault(); window.showBlogArticle('${article.id}')" class="font-semibold text-blue-500 hover:underline">Read More</a>
                </div>
            `;
            blogContainer.appendChild(articleElement);
        }

        newBlogPostForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const user = auth.currentUser;
            if (!user || user.isAnonymous) { window.showModal('Error', 'You must be logged in to publish a post.'); return; }

            const title = document.getElementById('new-blog-post-title').value;
            const content = document.getElementById('new-blog-post-content').value;
            const tags = document.getElementById('new-blog-post-tags').value.split(',').map(tag => tag.trim()).filter(Boolean);
            const imageFile = document.getElementById('new-blog-post-image').files[0];

            if (!title || !content) { window.showModal('Error', 'Title and content are required.'); return; }

            const submitBtn = newBlogPostForm.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Publishing...';

            try {
                let imageURL = '';
                if (imageFile) {
                    const storageRef = storage.ref(`blog_images/${user.uid}/${Date.now()}_${imageFile.name}`);
                    const snapshot = await storageRef.put(imageFile);
                    imageURL = await snapshot.ref.getDownloadURL();
                }

                const newArticle = {
                    title, content, tags, imageURL, userId: user.uid,
                    authorName: user.displayName || user.email.split('@')[0],
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection(`artifacts/${appId}/public/data/blog_articles`).add(newArticle);
                newBlogPostForm.reset();
                newBlogPostModal.classList.add('hidden');
                window.showModal('Success', 'Your new blog post has been published!');

            } catch (error) {
                console.error("Error publishing blog post:", error);
                window.showModal('Error', 'Failed to publish post.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Publish Post';
            }
        });
        
        window.showBlogArticle = (articleId) => {
            const article = allBlogArticles.find(a => a.id === articleId);
            if (!article) return;

            let deleteButtonHTML = '';
            if (article.userId === userId) {
                deleteButtonHTML = `<button onclick="window.deleteBlogArticle('${article.id}')" class="btn bg-red-500 text-white px-4 py-1 rounded-full text-sm">Delete Post</button>`;
            }

            blogArticleModalContent.innerHTML = `
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-2">${article.title}</h2>
                    ${deleteButtonHTML}
                </div>
                <p class="text-sm text-gray-500 mb-4">By ${article.authorName} • ${formatTimestamp(article.timestamp)}</p>
                ${article.imageURL ? `<img class="w-full h-64 object-cover rounded-lg my-4" src="${article.imageURL}" alt="${article.title}">` : ''}
                <div class="flex flex-wrap gap-2 mb-6">
                    ${(article.tags || []).map(tag => `<span class="bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full dark:bg-blue-200 dark:text-blue-800">#${tag}</span>`).join('')}
                </div>
                <div class="prose dark:prose-invert max-w-none whitespace-pre-wrap">${article.content}</div>
            `;
            blogArticleModal.classList.remove('hidden');
        };

        window.deleteBlogArticle = (articleId) => {
            window.showModal('Confirm Deletion', 'Are you sure you want to delete this blog post?', async () => {
                const articleToDelete = allBlogArticles.find(a => a.id === articleId);
                if (!articleToDelete) { window.showModal('Error', 'Could not find the article to delete.'); return; }

                try {
                    if (articleToDelete.imageURL) {
                        const imageRef = storage.refFromURL(articleToDelete.imageURL);
                        await imageRef.delete();
                    }
                    await db.doc(`artifacts/${appId}/public/data/blog_articles/${articleId}`).delete();
                    blogArticleModal.classList.add('hidden');
                    window.showModal('Success', 'The blog post has been deleted.');
                } catch (error) {
                    console.error("Error deleting blog article:", error);
                    window.showModal('Error', 'Failed to delete the post.');
                }
            }, true);
        };
        
        // --- General UI Logic & Event Listeners ---
        let currentSectionId = 'about';
        
        window.showSection = (sectionId) => {
            if (sectionId === currentSectionId) return;
            const currentSection = document.getElementById(currentSectionId);
            const nextSection = document.getElementById(sectionId);
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll(`.nav-btn[data-section="${sectionId}"]`).forEach(btn => btn.classList.add('active'));

            if (currentSection) {
                currentSection.style.opacity = '0';
                setTimeout(() => {
                    currentSection.classList.add('hidden');
                    if (nextSection) {
                        nextSection.classList.remove('hidden');
                        setTimeout(() => { nextSection.style.opacity = '1'; }, 20);
                    }
                    currentSectionId = sectionId;
                }, 300);
            }
            mobileMenu.classList.add('hidden');
            hamburgerBtn.setAttribute('aria-expanded', 'false');
        };
        
        window.showModal = (title, content, onConfirm, showConfirmCancel) => {
            modalTitle.textContent = title;
            modalContent.innerHTML = content;
            modalConfirmBtn.classList.toggle('hidden', !showConfirmCancel);

            if (showConfirmCancel && onConfirm) {
                const newConfirmBtn = modalConfirmBtn.cloneNode(true);
                modalConfirmBtn.parentNode.replaceChild(newConfirmBtn, modalConfirmBtn);
                newConfirmBtn.onclick = () => {
                    onConfirm();
                    window.hideModal();
                };
            }
            modal.classList.remove('opacity-0', 'pointer-events-none');
        }

        window.hideModal = () => { modal.classList.add('opacity-0', 'pointer-events-none'); }
        
        window.showLoginModal = () => { loginModal.classList.remove('opacity-0', 'pointer-events-none'); ui.start('#firebaseui-auth-container', uiConfig); }
        window.hideLoginModal = () => { loginModal.classList.add('opacity-0', 'pointer-events-none'); }
        
        const toggleDarkMode = async () => {
            const isDarkMode = document.documentElement.classList.toggle('dark');
            if (typedTextElement) { // Update cursor color class
                typedTextElement.classList.toggle('dark-mode', isDarkMode);
                typedTextElement.classList.toggle('light-mode', !isDarkMode);
            }
            const user = auth.currentUser;
            if (user && !user.isAnonymous) {
                try {
                    await db.doc(`artifacts/${appId}/users/${user.uid}/settings/theme`).set({ darkMode: isDarkMode });
                } catch (error) {
                    console.error("Failed to save dark mode settings:", error);
                }
            }
        };

        // --- Initial Execution ---
        document.addEventListener('DOMContentLoaded', () => {
            createBubbles();
            createFish();
            renderSkills();
            
            // Set initial section visibility
            document.querySelectorAll('main section').forEach(section => {
                if (section.id !== currentSectionId) {
                    section.classList.add('hidden');
                    section.style.opacity = '0';
                }
            });
            const firstSection = document.getElementById(currentSectionId);
            firstSection.classList.remove('hidden');
            setTimeout(() => {
                firstSection.style.opacity = '1';
                // Start typing animation AFTER the section is visible
                if (typedTextElement) {
                    typedTextElement.classList.add(document.documentElement.classList.contains('dark') ? 'dark-mode' : 'light-mode');
                    type();
                }
            }, 50); 
            
            document.querySelectorAll(`.nav-btn[data-section="${currentSectionId}"]`).forEach(btn => btn.classList.add('active'));

            // Attach event listeners
            modalCloseBtn.addEventListener('click', window.hideModal);
            hamburgerBtn.addEventListener('click', () => {
                const isHidden = mobileMenu.classList.toggle('hidden');
                hamburgerBtn.setAttribute('aria-expanded', String(!isHidden));
            });
            loginButtons.forEach(btn => btn.addEventListener('click', window.showLoginModal));
            logoutButtons.forEach(btn => btn.addEventListener('click', () => auth.signOut()));
            document.getElementById('login-modal-close-btn').addEventListener('click', window.hideLoginModal);
            darkModeToggle.addEventListener('click', toggleDarkMode);
            darkModeToggleMobile.addEventListener('click', toggleDarkMode);
            blogSearchInput.addEventListener('input', renderFilteredBlogArticles);
            newBlogPostBtn.addEventListener('click', () => newBlogPostModal.classList.remove('hidden'));
            document.getElementById('new-blog-post-close-btn').addEventListener('click', () => newBlogPostModal.classList.add('hidden'));
            blogArticleModalCloseBtn.addEventListener('click', () => blogArticleModal.classList.add('hidden'));
        });

    </script>
</body>
</html>
